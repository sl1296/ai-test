
F:\code\python\hand_writing\code>python b3.py
Training...
start: 2019-05-02 23:25:08.537107
b3.py:279: UserWarning: torch.nn.utils.clip_grad_norm is now deprecated in favor of torch.nn.utils.clip_grad_norm_.
  torch.nn.utils.clip_grad_norm(feature_encoder.parameters(),0.5)
b3.py:280: UserWarning: torch.nn.utils.clip_grad_norm is now deprecated in favor of torch.nn.utils.clip_grad_norm_.
  torch.nn.utils.clip_grad_norm(relation_network.parameters(),0.5)
episode: 0 loss 0.30841776728630066 acc: 0.0
2019-05-02 23:25:10.125420 use: 1.5883123874664307
episode: 20 loss 0.24816082417964935 acc: 0.0
2019-05-02 23:25:19.194945 use: 10.657837867736816
episode: 40 loss 0.2315487116575241 acc: 0.0
2019-05-02 23:25:28.229655 use: 19.69254732131958
episode: 60 loss 0.2065524309873581 acc: 0.01
2019-05-02 23:25:37.261441 use: 28.72433304786682
episode: 80 loss 0.19809216260910034 acc: 0.02666666666666667
2019-05-02 23:25:46.173366 use: 37.636258363723755
episode: 100 loss 0.18139392137527466 acc: 0.06
2019-05-02 23:25:55.131897 use: 46.59478998184204
episode: 120 loss 0.16398921608924866 acc: 0.06
2019-05-02 23:26:04.050498 use: 55.51339077949524
episode: 140 loss 0.1408749520778656 acc: 0.08666666666666667
2019-05-02 23:26:13.132004 use: 64.5948965549469
episode: 160 loss 0.13697431981563568 acc: 0.08666666666666667
2019-05-02 23:26:22.204490 use: 73.66738224029541
episode: 180 loss 0.13796314597129822 acc: 0.09666666666666666
2019-05-02 23:26:31.031716 use: 82.49460816383362
episode: 200 loss 0.1333368718624115 acc: 0.10333333333333333
2019-05-02 23:26:39.974373 use: 91.43726539611816
episode: 220 loss 0.13956396281719208 acc: 0.13333333333333333
2019-05-02 23:26:49.166983 use: 100.62987565994263
episode: 240 loss 0.11526647210121155 acc: 0.14666666666666667
2019-05-02 23:26:58.062545 use: 109.52543687820435
episode: 260 loss 0.12372283637523651 acc: 0.16666666666666666
2019-05-02 23:27:07.086267 use: 118.54915952682495
episode: 280 loss 0.12843509018421173 acc: 0.21
2019-05-02 23:27:16.080342 use: 127.54323434829712
episode: 300 loss 0.11095315963029861 acc: 0.25666666666666665
2019-05-02 23:27:25.005699 use: 136.46859121322632
episode: 320 loss 0.10514000803232193 acc: 0.3
2019-05-02 23:27:33.701376 use: 145.16426849365234
episode: 340 loss 0.11411526054143906 acc: 0.31333333333333335
2019-05-02 23:27:42.608042 use: 154.07093453407288
episode: 360 loss 0.09071306884288788 acc: 0.30666666666666664
2019-05-02 23:27:51.644726 use: 163.10761833190918
episode: 380 loss 0.08296286314725876 acc: 0.32666666666666666
2019-05-02 23:28:00.701345 use: 172.16423749923706
episode: 400 loss 0.08229966461658478 acc: 0.3566666666666667
2019-05-02 23:28:09.693110 use: 181.1560022830963
episode: 420 loss 0.08309146016836166 acc: 0.4066666666666667
2019-05-02 23:28:18.991800 use: 190.45469212532043
episode: 440 loss 0.07716663181781769 acc: 0.39
2019-05-02 23:28:28.044310 use: 199.50720286369324
episode: 460 loss 0.11004314571619034 acc: 0.31333333333333335
2019-05-02 23:28:37.004163 use: 208.4670557975769
episode: 480 loss 0.08816838264465332 acc: 0.42
2019-05-02 23:28:45.978652 use: 217.44154453277588
episode: 500 loss 0.07992488145828247 acc: 0.39666666666666667
2019-05-02 23:28:54.860691 use: 226.32358384132385
episode: 520 loss 0.07533182948827744 acc: 0.3433333333333333
2019-05-02 23:29:03.841237 use: 235.30412912368774
episode: 540 loss 0.09914156049489975 acc: 0.3433333333333333
2019-05-02 23:29:12.374341 use: 243.83723378181458
episode: 560 loss 0.1080775260925293 acc: 0.36666666666666664
2019-05-02 23:29:21.310095 use: 252.77298760414124
episode: 580 loss 0.0841006264090538 acc: 0.38
2019-05-02 23:29:30.229708 use: 261.69260001182556
episode: 600 loss 0.09766516834497452 acc: 0.37333333333333335
2019-05-02 23:29:39.183555 use: 270.64644718170166
episode: 620 loss 0.07848938554525375 acc: 0.4033333333333333
2019-05-02 23:29:48.666166 use: 280.12905836105347
episode: 640 loss 0.07362011820077896 acc: 0.38333333333333336
2019-05-02 23:29:57.637142 use: 289.10103368759155
episode: 660 loss 0.07786053419113159 acc: 0.42333333333333334
2019-05-02 23:30:06.552937 use: 298.0158290863037
episode: 680 loss 0.0738927572965622 acc: 0.41
2019-05-02 23:30:15.399045 use: 306.86193799972534
episode: 700 loss 0.09910468012094498 acc: 0.37333333333333335
2019-05-02 23:30:24.354039 use: 315.8169310092926
episode: 720 loss 0.0850573480129242 acc: 0.37666666666666665
2019-05-02 23:30:33.303641 use: 324.7665331363678
episode: 740 loss 0.08662285655736923 acc: 0.3566666666666667
2019-05-02 23:30:42.362014 use: 333.82490611076355
episode: 760 loss 0.06684612482786179 acc: 0.4066666666666667
2019-05-02 23:30:51.425272 use: 342.8881642818451
episode: 780 loss 0.08918874710798264 acc: 0.4066666666666667
2019-05-02 23:31:00.333363 use: 351.7962555885315
episode: 800 loss 0.07539782673120499 acc: 0.37666666666666665
2019-05-02 23:31:09.244787 use: 360.7076795101166
episode: 820 loss 0.08665339648723602 acc: 0.4266666666666667
2019-05-02 23:31:18.183099 use: 369.645991563797
episode: 840 loss 0.08820559829473495 acc: 0.37666666666666665
2019-05-02 23:31:27.086563 use: 378.5494558811188
episode: 860 loss 0.08285004645586014 acc: 0.39666666666666667
2019-05-02 23:31:36.032781 use: 387.49567317962646
episode: 880 loss 0.07408732175827026 acc: 0.41333333333333333
2019-05-02 23:31:45.063663 use: 396.52655577659607
episode: 900 loss 0.0883791521191597 acc: 0.4
2019-05-02 23:31:53.449350 use: 404.91224241256714
episode: 920 loss 0.08461536467075348 acc: 0.4266666666666667
2019-05-02 23:32:02.464351 use: 413.92724347114563
episode: 940 loss 0.06507092714309692 acc: 0.44333333333333336
2019-05-02 23:32:11.410621 use: 422.87351298332214
episode: 960 loss 0.060801900923252106 acc: 0.41333333333333333
2019-05-02 23:32:20.398835 use: 431.8617277145386
episode: 980 loss 0.05964074656367302 acc: 0.44
2019-05-02 23:32:29.358534 use: 440.8224313259125
Testing...
3092 3193 4.72808051109314 70 0.0
2405 1675 4.683817207813263 25 0.0
3698 359 3.5457228124141693 526 0.0
2882 3388 4.872166395187378 9 0.0
3745 391 4.715979695320129 93 0.0
3397 1713 4.8039745688438416 15 0.0
914 2523 3.9612773656845093 58 0.0
667 3290 4.805593192577362 20 0.0
3680 3680 4.994199812412262 0 0.1111111111111111
157 1449 0.6427909582853317 3473 0.1
2815 875 3.2939096838235855 713 0.09090909090909091
1518 740 1.3520165807567537 2471 0.08333333333333333
602 166 4.425025105476379 159 0.07692307692307693
935 935 4.88531494140625 0 0.14285714285714285
1377 2770 4.700450241565704 74 0.13333333333333333
2110 2518 4.107903838157654 158 0.125
2504 1773 3.544030088931322 895 0.11764705882352941
2424 2195 4.63028872013092 114 0.1111111111111111
1005 3008 3.8617506623268127 354 0.10526315789473684
584 1769 2.7435665130615234 655 0.1
2328 3480 4.649135529994965 118 0.09523809523809523
3414 3414 4.972950100898743 0 0.13636363636363635
3029 3029 4.955207347869873 0 0.17391304347826086
2103 1237 4.4181607365608215 78 0.16666666666666666
676 676 4.9650344252586365 0 0.2
2812 575 4.142167687416077 91 0.19230769230769232
2162 1525 3.582646980881691 462 0.18518518518518517
1461 1644 4.972190201282501 11 0.17857142857142858
1759 1324 4.827902793884277 11 0.1724137931034483
2831 1612 4.803680777549744 21 0.16666666666666666
3280 625 2.6229688823223114 712 0.16129032258064516
2899 3452 4.941936254501343 8 0.15625
1860 1858 4.2952123284339905 189 0.15151515151515152
1888 1910 4.2878968715667725 135 0.14705882352941177
2742 2637 3.739387108013034 449 0.14285714285714285
1238 2612 4.327012777328491 268 0.1388888888888889
454 44 4.405267775058746 122 0.13513513513513514
1455 1591 4.937046229839325 9 0.13157894736842105
1947 1947 4.9526753425598145 0 0.15384615384615385
990 990 4.942437648773193 0 0.175
78 2665 4.52987277507782 78 0.17073170731707318
433 3135 4.8196616768836975 32 0.16666666666666666
262 924 4.704674005508423 106 0.16279069767441862
963 2518 4.291235327720642 118 0.1590909090909091
1677 2639 4.364735662937164 94 0.15555555555555556
1258 2639 3.464071746915579 378 0.15217391304347827
2205 1279 4.77285361289978 40 0.14893617021276595
1935 3451 3.497950240969658 160 0.14583333333333334
1870 1870 4.982721626758575 0 0.16326530612244897
2318 3265 4.762273788452148 14 0.16
2019-05-02 23:46:03.220485 use: 1254.6833777427673
episode: 1000 loss 0.08466856926679611 acc: 0.43
2019-05-02 23:46:03.715521 use: 1255.1784131526947
episode: 1020 loss 0.078524649143219 acc: 0.44
2019-05-02 23:46:12.748919 use: 1264.211811542511
episode: 1040 loss 0.06599470973014832 acc: 0.4633333333333333
2019-05-02 23:46:21.706597 use: 1273.169489145279
episode: 1060 loss 0.09753447771072388 acc: 0.4066666666666667
2019-05-02 23:46:30.555944 use: 1282.018836736679
episode: 1080 loss 0.07202816754579544 acc: 0.44
2019-05-02 23:46:39.377200 use: 1290.8400926589966
episode: 1100 loss 0.08157165348529816 acc: 0.45
2019-05-02 23:46:48.503310 use: 1299.9662027359009
episode: 1120 loss 0.05785258859395981 acc: 0.46
2019-05-02 23:46:57.179363 use: 1308.642255783081
episode: 1140 loss 0.07084455341100693 acc: 0.4633333333333333
2019-05-02 23:47:06.346890 use: 1317.809782743454
episode: 1160 loss 0.07607010751962662 acc: 0.45666666666666667
2019-05-02 23:47:15.180682 use: 1326.643573999405
episode: 1180 loss 0.0783311128616333 acc: 0.45666666666666667
2019-05-02 23:47:23.984681 use: 1335.4475739002228
episode: 1200 loss 0.0715865045785904 acc: 0.43
2019-05-02 23:47:32.527822 use: 1343.9907143115997
episode: 1220 loss 0.0794244110584259 acc: 0.45666666666666667
2019-05-02 23:47:41.945381 use: 1353.4082734584808
episode: 1240 loss 0.07528718560934067 acc: 0.44666666666666666
2019-05-02 23:47:50.934488 use: 1362.3973805904388
episode: 1260 loss 0.07417574524879456 acc: 0.43
2019-05-02 23:47:59.894053 use: 1371.356945991516
episode: 1280 loss 0.06334704160690308 acc: 0.47
2019-05-02 23:48:08.646619 use: 1380.1095118522644
episode: 1300 loss 0.06120658293366432 acc: 0.4633333333333333
2019-05-02 23:48:17.610146 use: 1389.073038816452
episode: 1320 loss 0.08774802088737488 acc: 0.44
2019-05-02 23:48:26.674699 use: 1398.1375918388367
episode: 1340 loss 0.06570280343294144 acc: 0.46
2019-05-02 23:48:35.920753 use: 1407.3836455345154
episode: 1360 loss 0.05948015674948692 acc: 0.4633333333333333
2019-05-02 23:48:45.019724 use: 1416.4826164245605
episode: 1380 loss 0.07694807648658752 acc: 0.44
2019-05-02 23:48:54.070369 use: 1425.5332612991333
episode: 1400 loss 0.07467415928840637 acc: 0.45
2019-05-02 23:49:03.024062 use: 1434.4869549274445
episode: 1420 loss 0.08548309653997421 acc: 0.44333333333333336
2019-05-02 23:49:12.317506 use: 1443.7803983688354
episode: 1440 loss 0.0633607804775238 acc: 0.43666666666666665
2019-05-02 23:49:21.330504 use: 1452.793396472931
episode: 1460 loss 0.07089822739362717 acc: 0.43666666666666665
2019-05-02 23:49:30.338112 use: 1461.8010051250458
episode: 1480 loss 0.07266278564929962 acc: 0.48
2019-05-02 23:49:39.104714 use: 1470.56760597229
episode: 1500 loss 0.06519974023103714 acc: 0.48
2019-05-02 23:49:48.045840 use: 1479.508731842041
episode: 1520 loss 0.057777613401412964 acc: 0.47
2019-05-02 23:49:57.015163 use: 1488.478055715561
episode: 1540 loss 0.06705833226442337 acc: 0.44333333333333336
2019-05-02 23:50:05.980723 use: 1497.4436151981354
episode: 1560 loss 0.07365278899669647 acc: 0.43
2019-05-02 23:50:14.926722 use: 1506.3896143436432
episode: 1580 loss 0.08496570587158203 acc: 0.43666666666666665
2019-05-02 23:50:24.006579 use: 1515.4694712162018
episode: 1600 loss 0.07954933494329453 acc: 0.4766666666666667
2019-05-02 23:50:33.005725 use: 1524.4686172008514
episode: 1620 loss 0.06465821713209152 acc: 0.43666666666666665
2019-05-02 23:50:41.998600 use: 1533.4614925384521
episode: 1640 loss 0.07428287714719772 acc: 0.43666666666666665
2019-05-02 23:50:51.109634 use: 1542.5725264549255
episode: 1660 loss 0.06230182573199272 acc: 0.44666666666666666
2019-05-02 23:50:59.596239 use: 1551.0591316223145
episode: 1680 loss 0.05718928202986717 acc: 0.49
2019-05-02 23:51:08.569637 use: 1560.032529592514
episode: 1700 loss 0.07205250859260559 acc: 0.47
2019-05-02 23:51:17.377870 use: 1568.8407621383667
episode: 1720 loss 0.07398595660924911 acc: 0.43666666666666665
2019-05-02 23:51:26.350869 use: 1577.8137609958649
episode: 1740 loss 0.06766007840633392 acc: 0.4766666666666667
2019-05-02 23:51:35.220869 use: 1586.6837618350983
episode: 1760 loss 0.03826703876256943 acc: 0.5033333333333333
2019-05-02 23:51:44.174014 use: 1595.636906862259
episode: 1780 loss 0.09039807319641113 acc: 0.45
2019-05-02 23:51:53.068244 use: 1604.5311369895935
episode: 1800 loss 0.0851449966430664 acc: 0.45
2019-05-02 23:52:01.936278 use: 1613.3991703987122
episode: 1820 loss 0.06230785697698593 acc: 0.44333333333333336
2019-05-02 23:52:10.875415 use: 1622.3383078575134
episode: 1840 loss 0.05068255588412285 acc: 0.47
2019-05-02 23:52:19.817583 use: 1631.2804753780365
episode: 1860 loss 0.053944192826747894 acc: 0.4666666666666667
2019-05-02 23:52:28.808361 use: 1640.2712531089783
episode: 1880 loss 0.06288327276706696 acc: 0.48333333333333334
2019-05-02 23:52:37.835908 use: 1649.2988007068634
episode: 1900 loss 0.06874804198741913 acc: 0.44666666666666666
2019-05-02 23:52:46.822528 use: 1658.2854208946228
episode: 1920 loss 0.045383960008621216 acc: 0.5066666666666667
2019-05-02 23:52:55.599914 use: 1667.0628063678741
episode: 1940 loss 0.03879990056157112 acc: 0.5133333333333333
2019-05-02 23:53:04.642435 use: 1676.1053276062012
episode: 1960 loss 0.08584223687648773 acc: 0.45
2019-05-02 23:53:13.650435 use: 1685.1133270263672
episode: 1980 loss 0.0513959601521492 acc: 0.4766666666666667
2019-05-02 23:53:22.600571 use: 1694.0634636878967
Testing...
503 3064 4.862340331077576 9 0.0
1502 545 3.901688367128372 116 0.0
1535 2556 4.847974538803101 8 0.0
1180 1694 4.701300263404846 70 0.0
3050 3050 4.870758950710297 0 0.2
2795 2448 4.582927048206329 28 0.16666666666666666
3509 1609 4.471398055553436 217 0.14285714285714285
1757 2965 4.362377941608429 131 0.125
3170 682 4.512562811374664 62 0.1111111111111111
498 1244 4.768346667289734 9 0.1
3601 3586 3.5866503417491913 376 0.09090909090909091
3506 2329 4.766428828239441 42 0.08333333333333333
1680 2862 4.1665820479393005 112 0.07692307692307693
709 2591 3.0024204552173615 930 0.07142857142857142
2697 1853 4.92310106754303 22 0.06666666666666667
1947 1947 4.997570216655731 0 0.125
2168 811 4.9857707023620605 2 0.11764705882352941
2016 3409 4.613215923309326 32 0.1111111111111111
1225 1225 4.975726127624512 0 0.15789473684210525
3056 3467 4.784567415714264 15 0.15
1392 1391 4.995360314846039 2 0.14285714285714285
1151 1569 4.299157679080963 53 0.13636363636363635
637 2338 4.256911933422089 184 0.13043478260869565
174 1759 4.796908020973206 90 0.125
14 20 4.883407831192017 2 0.12
1592 2406 4.176582187414169 57 0.11538461538461539
527 3155 4.874223053455353 6 0.1111111111111111
3276 167 4.271455228328705 29 0.10714285714285714
2414 2632 4.354866683483124 137 0.10344827586206896
1022 768 3.8605507910251617 148 0.1
3109 3669 4.892863929271698 9 0.0967741935483871
630 630 4.982427358627319 0 0.125
2015 1873 3.6911352574825287 460 0.12121212121212122
2676 761 4.954342305660248 2 0.11764705882352941
Traceback (most recent call last):
  File "b3.py", line 356, in <module>
    main()
  File "b3.py", line 324, in main
    batches=torch.zeros(sz*5, 1, 84, 84)
RuntimeError: $ Torch: not enough memory: you tried to allocate 0GB. Buy new RAM! at ..\aten\src\TH\THGeneral.cpp:201

F:\code\python\hand_writing\code>