
F:\code\python\hand_writing\code>python b4++.py
Training...
start: 2019-05-04 23:09:11.134660
Testing...
1820 1820 4.999783277511597 0 1.0|| 1820 1.0
Traceback (most recent call last):
  File "b4++.py", line 403, in <module>
    main()
  File "b4++.py", line 350, in main
    batch_features = feature_encoder(Variable(batches).cuda())
  File "C:\Program Files\Python37\lib\site-packages\torch\nn\modules\module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "b4++.py", line 158, in forward
    out = self.layer1(x)
  File "C:\Program Files\Python37\lib\site-packages\torch\nn\modules\module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Program Files\Python37\lib\site-packages\torch\nn\modules\container.py", line 92, in forward
    input = module(input)
  File "C:\Program Files\Python37\lib\site-packages\torch\nn\modules\module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Program Files\Python37\lib\site-packages\torch\nn\modules\activation.py", line 50, in forward
    return F.threshold(input, self.threshold, self.value, self.inplace)
  File "C:\Program Files\Python37\lib\site-packages\torch\nn\functional.py", line 840, in threshold
    result = _VF.threshold(input, threshold, value)
RuntimeError: CUDA out of memory. Tried to allocate 287.38 MiB (GPU 0; 8.00 GiB total capacity; 5.19 GiB already allocated; 159.04 MiB free; 939.70 MiB cached)

F:\code\python\hand_writing\code>python b4++.py
Training...
start: 2019-05-04 23:10:48.010871
Testing...
2767 1176 4.9527159333229065 31 0.0|| 3529 0.0
2047 638 4.989310145378113 16 0.0|| 638 0.0
2692 2692 4.999055862426758 0 0.3333333333333333|| 2692 0.3333333333333333
2497 2497 4.9999624490737915 0 0.5|| 2497 0.5
1074 3095 4.995568633079529 1 0.4|| 1074 0.6
1918 1337 4.984613478183746 11 0.3333333333333333|| 2678 0.5
1326 1326 4.999327540397644 0 0.42857142857142855|| 2683 0.42857142857142855
3367 26 4.951686263084412 37 0.375|| 26 0.375
900 900 4.999886751174927 0 0.4444444444444444|| 900 0.4444444444444444
68 377 4.979544043540955 34 0.4|| 2992 0.4
359 359 4.999933481216431 0 0.45454545454545453|| 359 0.45454545454545453
3401 1193 4.88547283411026 66 0.4166666666666667|| 3586 0.4166666666666667
3540 3540 4.999952554702759 0 0.46153846153846156|| 3540 0.46153846153846156
3693 3693 4.99994695186615 0 0.5|| 1269 0.42857142857142855
3390 1620 4.916076123714447 75 0.4666666666666667|| 1400 0.4
1887 1797 4.889773309230804 129 0.4375|| 1876 0.375
865 865 4.999570786952972 0 0.47058823529411764|| 865 0.4117647058823529
1387 1387 4.999765634536743 0 0.5|| 2082 0.3888888888888889
1933 1933 4.999867916107178 0 0.5263157894736842|| 1933 0.42105263157894735
3010 1417 4.995351076126099 18 0.5|| 3658 0.4
951 2064 4.999621272087097 4 0.47619047619047616|| 2064 0.38095238095238093
230 230 4.998890459537506 0 0.5|| 230 0.4090909090909091
1639 352 4.999843597412109 2 0.4782608695652174|| 2303 0.391304347826087
901 1806 4.99666029214859 8 0.4583333333333333|| 901 0.4166666666666667
483 484 4.999875903129578 1 0.44|| 483 0.44
3731 3731 4.999965190887451 0 0.46153846153846156|| 3731 0.46153846153846156
2703 3043 4.999308705329895 3 0.4444444444444444|| 2703 0.48148148148148145
3493 309 4.996676564216614 13 0.42857142857142855|| 2179 0.4642857142857143
893 294 4.967374622821808 21 0.41379310344827586|| 499 0.4482758620689655
2756 773 4.999593019485474 1 0.4|| 2756 0.4666666666666667
2539 2209 4.982605874538422 14 0.3870967741935484|| 932 0.45161290322580644
2303 1797 4.989925980567932 19 0.375|| 125 0.4375
2987 1207 4.995556473731995 10 0.36363636363636365|| 2007 0.42424242424242425
2490 2490 4.999785780906677 0 0.38235294117647056|| 2031 0.4117647058823529
2212 3089 4.9977498054504395 16 0.37142857142857144|| 3089 0.4
3437 357 4.975196719169617 12 0.3611111111111111|| 357 0.3888888888888889
625 2238 4.979736387729645 3 0.35135135135135137|| 2238 0.3783783783783784
2639 2639 4.999929070472717 0 0.3684210526315789|| 2639 0.39473684210526316
3740 3740 4.99974524974823 0 0.38461538461538464|| 3740 0.41025641025641024
3416 453 4.995592415332794 7 0.375|| 453 0.4
473 1316 4.941653847694397 21 0.36585365853658536|| 2824 0.3902439024390244
3127 36 4.986106336116791 52 0.35714285714285715|| 36 0.38095238095238093
1682 2044 4.999093174934387 4 0.3488372093023256|| 2044 0.37209302325581395
936 2971 4.99715381860733 1 0.3409090909090909|| 2971 0.36363636363636365
710 713 4.988086640834808 7 0.3333333333333333|| 713 0.35555555555555557
3472 1105 4.999231696128845 2 0.32608695652173914|| 3472 0.3695652173913043
1445 1619 4.67897754907608 89 0.3191489361702128|| 1619 0.3617021276595745
2971 2971 4.999901652336121 0 0.3333333333333333|| 2971 0.375
2839 2839 4.99998927116394 0 0.3469387755102041|| 2839 0.3877551020408163
2922 2922 4.999365389347076 0 0.36|| 3746 0.38
2019-05-04 23:24:24.300053 use: 816.2891826629639
Testing...
96 649 4.997115969657898 43 0.0|| 649 0.0
2518 2518 4.999325811862946 0 0.5|| 2518 0.5
3353 3045 4.991542994976044 17 0.3333333333333333|| 146 0.3333333333333333
2428 2895 4.999443888664246 1 0.25|| 2895 0.25
1706 1706 4.999998450279236 0 0.4|| 1706 0.4
3426 787 4.997160732746124 6 0.3333333333333333|| 3426 0.5
3632 2387 4.983464300632477 53 0.2857142857142857|| 3729 0.42857142857142855
1850 1850 4.999954700469971 0 0.375|| 1850 0.5
2483 2110 4.994583070278168 9 0.3333333333333333|| 2299 0.4444444444444444
209 209 4.999665677547455 0 0.4|| 209 0.5
3082 964 4.927124977111816 89 0.36363636363636365|| 964 0.45454545454545453
2967 775 4.99973851442337 1 0.3333333333333333|| 2967 0.5
1595 3 4.999856233596802 1 0.3076923076923077|| 3 0.46153846153846156
1280 3524 4.977642714977264 46 0.2857142857142857|| 3026 0.42857142857142855
2024 2024 4.9999847412109375 0 0.3333333333333333|| 2024 0.4666666666666667
1768 567 4.416790127754211 141 0.3125|| 1554 0.4375
1966 735 4.999099969863892 5 0.29411764705882354|| 88 0.4117647058823529
1649 1649 4.999845027923584 0 0.3333333333333333|| 1649 0.4444444444444444
3499 3499 4.999887943267822 0 0.3684210526315789|| 3499 0.47368421052631576
3471 2156 4.999714434146881 3 0.35|| 3471 0.5
1823 1823 4.99995219707489 0 0.38095238095238093|| 2436 0.47619047619047616
2060 2060 4.9999916553497314 0 0.4090909090909091|| 2060 0.5
3238 1902 4.988121449947357 10 0.391304347826087|| 2062 0.4782608695652174
2229 2229 4.999967575073242 0 0.4166666666666667|| 3505 0.4583333333333333
899 2732 4.999636292457581 4 0.4|| 2553 0.44
2423 2475 4.999747574329376 1 0.38461538461538464|| 2475 0.4230769230769231
2849 2849 4.9989800453186035 0 0.4074074074074074|| 2849 0.4444444444444444
1210 2667 4.982422888278961 34 0.39285714285714285|| 2667 0.42857142857142855
2199 1093 4.9997464418411255 1 0.3793103448275862|| 513 0.41379310344827586
3295 3295 4.998755156993866 0 0.4|| 3295 0.43333333333333335
748 2962 4.93443101644516 78 0.3870967741935484|| 2962 0.41935483870967744
735 735 4.999980092048645 0 0.40625|| 735 0.4375
1770 1770 4.999922275543213 0 0.42424242424242425|| 1770 0.45454545454545453
125 125 4.999959230422974 0 0.4411764705882353|| 125 0.47058823529411764
1763 1374 4.688515245914459 89 0.42857142857142855|| 3176 0.45714285714285713
1929 345 4.996996521949768 4 0.4166666666666667|| 1929 0.4722222222222222
2355 1579 4.998323500156403 2 0.40540540540540543|| 2355 0.4864864864864865
2514 1490 4.971788227558136 48 0.39473684210526316|| 2789 0.47368421052631576
2885 769 4.997772753238678 5 0.38461538461538464|| 3713 0.46153846153846156
3640 3707 4.941259920597076 97 0.375|| 3707 0.45
3520 569 4.743405222892761 79 0.36585365853658536|| 3368 0.43902439024390244
3731 3731 4.999979138374329 0 0.38095238095238093|| 3731 0.4523809523809524
2190 3044 4.999587535858154 2 0.37209302325581395|| 2987 0.4418604651162791
1223 3113 4.979130983352661 55 0.36363636363636365|| 1562 0.4318181818181818
1999 1999 4.999944448471069 0 0.37777777777777777|| 1999 0.4444444444444444
2740 394 4.998516023159027 1 0.3695652173913043|| 2740 0.45652173913043476
1545 1545 4.99998152256012 0 0.3829787234042553|| 1545 0.46808510638297873
2702 1158 4.992526650428772 20 0.375|| 3738 0.4583333333333333
3728 87 4.998947024345398 3 0.3673469387755102|| 87 0.4489795918367347
488 488 4.999935746192932 0 0.38|| 488 0.46
2019-05-04 23:37:57.778253 use: 1629.7673826217651
Testing...
1964 3151 4.990213930606842 10 0.0|| 138 0.0
1695 1557 4.9985843896865845 9 0.0|| 1557 0.0
3022 3022 4.9998979568481445 0 0.3333333333333333|| 3022 0.3333333333333333
3041 3323 4.991246461868286 37 0.25|| 1421 0.25
390 2272 4.269678294658661 286 0.2|| 2272 0.2
2258 2258 4.999429225921631 0 0.3333333333333333|| 2258 0.3333333333333333
3715 689 4.988857567310333 3 0.2857142857142857|| 3715 0.42857142857142855
828 3148 4.9954275488853455 8 0.25|| 2204 0.375
1192 1192 4.999880075454712 0 0.3333333333333333|| 1192 0.4444444444444444
2875 1731 4.998281419277191 1 0.3|| 1731 0.4
1265 253 4.990922451019287 7 0.2727272727272727|| 1265 0.45454545454545453
3183 1153 4.9998170137405396 1 0.25|| 3183 0.5
995 2814 4.756109535694122 151 0.23076923076923078|| 365 0.46153846153846156
2178 2178 4.999988079071045 0 0.2857142857142857|| 2178 0.5
2097 1007 4.972514867782593 47 0.26666666666666666|| 2302 0.4666666666666667
1969 95 4.994927227497101 7 0.25|| 1969 0.5
3656 3656 4.999360382556915 0 0.29411764705882354|| 3656 0.5294117647058824
978 978 4.999905705451965 0 0.3333333333333333|| 978 0.5555555555555556
1242 2946 4.995973169803619 13 0.3157894736842105|| 2636 0.5263157894736842
1682 1682 4.9996331334114075 0 0.35|| 1682 0.55
2048 234 3.709698051214218 496 0.3333333333333333|| 2483 0.5238095238095238
2917 2917 4.999970316886902 0 0.36363636363636365|| 2917 0.5454545454545454
2789 2789 4.999926686286926 0 0.391304347826087|| 2789 0.5652173913043478
461 3528 4.989265143871307 7 0.375|| 461 0.5833333333333334
441 1176 4.998992681503296 1 0.36|| 441 0.6
3202 651 4.991774618625641 33 0.34615384615384615|| 2556 0.5769230769230769
1569 3542 4.998310804367065 4 0.3333333333333333|| 1569 0.5925925925925926
672 1699 4.9999330043792725 4 0.32142857142857145|| 672 0.6071428571428571
1464 1677 4.975414156913757 18 0.3103448275862069|| 1677 0.5862068965517241
1608 1833 4.9911633133888245 6 0.3|| 2679 0.5666666666666667
1497 1497 4.999982595443726 0 0.3225806451612903|| 1497 0.5806451612903226
554 3506 4.981925010681152 4 0.3125|| 1122 0.5625
283 1666 4.994657337665558 6 0.30303030303030304|| 253 0.5454545454545454
3396 1525 4.963055491447449 23 0.29411764705882354|| 1525 0.5294117647058824
1112 393 4.97093003988266 24 0.2857142857142857|| 1539 0.5142857142857142
710 1793 4.999754965305328 1 0.2777777777777778|| 710 0.5277777777777778
2593 2593 4.99978631734848 0 0.2972972972972973|| 2593 0.5405405405405406
2029 3148 4.998929381370544 1 0.2894736842105263|| 211 0.5263157894736842
1042 1305 4.999861717224121 1 0.28205128205128205|| 1042 0.5384615384615384
1029 3256 4.988954484462738 13 0.275|| 2330 0.525
681 681 4.9996337890625 0 0.2926829268292683|| 47 0.5121951219512195
1941 2088 4.998281240463257 1 0.2857142857142857|| 2088 0.5
981 981 4.999985694885254 0 0.3023255813953488|| 981 0.5116279069767442
1599 610 4.9995827078819275 12 0.29545454545454547|| 3684 0.5
1268 641 4.9981154799461365 1 0.28888888888888886|| 1268 0.5111111111111111
1726 1726 4.999879598617554 0 0.30434782608695654|| 1726 0.5217391304347826
2861 2397 4.941933691501617 44 0.2978723404255319|| 2785 0.5106382978723404
2823 2823 4.999844193458557 0 0.3125|| 1988 0.5
801 2923 4.287272900342941 207 0.30612244897959184|| 2641 0.4897959183673469
3665 291 4.998875439167023 1 0.3|| 3665 0.5
2019-05-04 23:51:33.090091 use: 2445.0792207717896
Testing...
2664 2664 4.999981164932251 0 1.0|| 2345 0.0
1457 993 4.901559412479401 82 0.5|| 3393 0.0
2884 2137 4.99950385093689 29 0.3333333333333333|| 1891 0.0
3664 2171 4.9988062381744385 1 0.25|| 983 0.0
1353 2514 4.950645923614502 24 0.2|| 2842 0.0
1984 1984 4.999820590019226 0 0.3333333333333333|| 1984 0.16666666666666666
1885 1885 4.999889016151428 0 0.42857142857142855|| 1885 0.2857142857142857
1470 991 4.999248802661896 1 0.375|| 991 0.25
1562 2621 4.999640107154846 3 0.3333333333333333|| 1562 0.3333333333333333
840 877 4.998642563819885 1 0.3|| 840 0.4
756 756 4.999596953392029 0 0.36363636363636365|| 756 0.45454545454545453
3255 1773 4.999684393405914 2 0.3333333333333333|| 3255 0.5
3665 1552 4.997227847576141 1 0.3076923076923077|| 3665 0.5384615384615384
1486 141 4.998729348182678 7 0.2857142857142857|| 874 0.5
2265 3256 4.999889373779297 1 0.26666666666666666|| 2265 0.5333333333333333
232 232 4.9986860156059265 0 0.3125|| 232 0.5625
1629 1629 4.999834895133972 0 0.35294117647058826|| 1629 0.5882352941176471
3516 188 4.998601198196411 1 0.3333333333333333|| 2036 0.5555555555555556
1820 1820 4.999790549278259 0 0.3684210526315789|| 1820 0.5789473684210527
724 3346 4.998986780643463 2 0.35|| 724 0.6
3347 3347 4.999873042106628 0 0.38095238095238093|| 3347 0.6190476190476191
2561 1197 4.999627947807312 2 0.36363636363636365|| 2561 0.6363636363636364
3429 1165 3.2738703191280365 969 0.34782608695652173|| 2587 0.6086956521739131
3009 3009 4.9998838901519775 0 0.375|| 3009 0.625
2142 2142 4.999821305274963 0 0.4|| 2142 0.64
1533 1521 4.988163948059082 8 0.38461538461538464|| 1533 0.6538461538461539
2059 2059 4.999925494194031 0 0.4074074074074074|| 2059 0.6666666666666666
1685 2704 4.868984758853912 94 0.39285714285714285|| 2704 0.6428571428571429
2390 2390 4.999356389045715 0 0.41379310344827586|| 2390 0.6551724137931034
2051 2051 4.9999061822891235 0 0.43333333333333335|| 2051 0.6666666666666666
3306 3306 4.999557554721832 0 0.45161290322580644|| 3306 0.6774193548387096
912 925 4.999130368232727 1 0.4375|| 484 0.65625
1076 610 4.999311983585358 3 0.42424242424242425|| 1076 0.6666666666666666
1735 1774 4.9954469203948975 7 0.4117647058823529|| 50 0.6470588235294118
2419 2510 4.99788236618042 10 0.4|| 3697 0.6285714285714286
1082 1082 4.9999470710754395 0 0.4166666666666667|| 1082 0.6388888888888888
1058 1058 4.99993097782135 0 0.43243243243243246|| 1058 0.6486486486486487
1218 3619 4.99498176574707 3 0.42105263157894735|| 349 0.631578947368421
784 784 4.999768018722534 0 0.4358974358974359|| 784 0.6410256410256411
3120 2615 4.97040319442749 71 0.425|| 2615 0.625
1445 1445 4.997659981250763 0 0.43902439024390244|| 1445 0.6341463414634146
3230 3230 4.999911546707153 0 0.4523809523809524|| 3230 0.6428571428571429
1579 557 4.999542057514191 2 0.4418604651162791|| 1579 0.6511627906976745
1727 2178 4.999908804893494 1 0.4318181818181818|| 2178 0.6363636363636364
831 155 4.922593891620636 28 0.4222222222222222|| 155 0.6222222222222222
2333 2908 4.995585560798645 4 0.41304347826086957|| 2333 0.6304347826086957
2936 3386 4.869384407997131 161 0.40425531914893614|| 983 0.6170212765957447
16 1364 4.9178831577301025 55 0.3958333333333333|| 3675 0.6041666666666666
490 490 4.999831318855286 0 0.40816326530612246|| 490 0.6122448979591837
2789 2738 4.998017609119415 6 0.4|| 2433 0.6
2019-05-05 00:05:09.874852 use: 3261.863981962204
Testing...
1824 2125 4.998954236507416 1 0.0|| 2125 0.0
3581 2865 4.994275629520416 4 0.0|| 2865 0.0
836 836 4.999676704406738 0 0.3333333333333333|| 836 0.3333333333333333
2694 2694 4.999910354614258 0 0.5|| 2694 0.5
1351 3619 4.999126613140106 5 0.4|| 1351 0.6
2078 2104 4.999673843383789 1 0.3333333333333333|| 2078 0.6666666666666666
2186 2186 4.999812006950378 0 0.42857142857142855|| 2892 0.5714285714285714
2651 1334 4.991871774196625 11 0.375|| 954 0.5
2260 3215 4.996845245361328 3 0.3333333333333333|| 3324 0.4444444444444444
1997 3102 4.965522408485413 36 0.3|| 1498 0.4
3481 3481 4.9999260902404785 0 0.36363636363636365|| 3481 0.45454545454545453
2066 2066 4.999930739402771 0 0.4166666666666667|| 2066 0.5
1124 778 4.999845027923584 1 0.38461538461538464|| 1124 0.5384615384615384
502 502 4.999922275543213 0 0.42857142857142855|| 502 0.5714285714285714
2160 2160 4.998638570308685 0 0.4666666666666667|| 2160 0.6
3296 775 4.9978222250938416 7 0.4375|| 1374 0.5625
1161 1750 4.052181776612997 350 0.4117647058823529|| 2355 0.5294117647058824
2532 275 4.997385859489441 1 0.3888888888888889|| 2532 0.5555555555555556
3028 3028 4.999904155731201 0 0.42105263157894735|| 3028 0.5789473684210527
1157 1157 4.997986853122711 0 0.45|| 1157 0.6
2916 1930 4.986687660217285 21 0.42857142857142855|| 3659 0.5714285714285714
2364 1714 4.997676432132721 4 0.4090909090909091|| 2364 0.5909090909090909
1785 1565 4.993947207927704 9 0.391304347826087|| 1787 0.5652173913043478
776 1563 4.99796450138092 4 0.375|| 274 0.5416666666666666
605 605 4.9999953508377075 0 0.4|| 605 0.56
610 2367 4.999950408935547 14 0.38461538461538464|| 1891 0.5384615384615384
20 1316 4.999327003955841 2 0.37037037037037035|| 20 0.5555555555555556
1846 2036 4.997426927089691 3 0.35714285714285715|| 3061 0.5357142857142857
2821 2821 4.999995946884155 0 0.3793103448275862|| 2821 0.5517241379310345
2111 3372 4.8526493310928345 121 0.36666666666666664|| 1987 0.5333333333333333
3480 2367 4.998687148094177 11 0.3548387096774194|| 2367 0.5161290322580645
1517 2012 4.858476400375366 44 0.34375|| 2546 0.5
424 1985 4.96471381187439 28 0.3333333333333333|| 1985 0.48484848484848486
3241 82 4.999691605567932 1 0.3235294117647059|| 3241 0.5
1545 2075 4.876632809638977 106 0.3142857142857143|| 941 0.4857142857142857
1345 2210 4.99679034948349 7 0.3055555555555556|| 2328 0.4722222222222222
3740 7 4.999660491943359 1 0.2972972972972973|| 3740 0.4864864864864865
1443 2345 4.9988625049591064 1 0.2894736842105263|| 58 0.47368421052631576
2242 1714 4.9980040192604065 4 0.28205128205128205|| 1714 0.46153846153846156
3437 3437 4.999514997005463 0 0.3|| 3437 0.475
664 903 4.999620676040649 1 0.2926829268292683|| 664 0.4878048780487805
1354 1354 4.999895095825195 0 0.30952380952380953|| 1354 0.5
2241 2241 4.999395906925201 0 0.32558139534883723|| 2241 0.5116279069767442
2741 97 4.997162103652954 9 0.3181818181818182|| 2741 0.5227272727272727
633 3333 4.99921441078186 3 0.3111111111111111|| 633 0.5333333333333333
2126 3315 4.038462020456791 435 0.30434782608695654|| 3315 0.5217391304347826
652 2761 4.999871611595154 1 0.2978723404255319|| 652 0.5319148936170213
2218 3389 4.999683678150177 1 0.2916666666666667|| 2218 0.5416666666666666
3248 3248 4.999925255775452 0 0.30612244897959184|| 3248 0.5510204081632653
3024 1440 4.998660445213318 4 0.3|| 3024 0.56
2019-05-05 00:18:43.991851 use: 4075.980980873108
Testing...
Traceback (most recent call last):
  File "b4++.py", line 403, in <module>
    main()
  File "b4++.py", line 348, in main
    samples[k*5+l] = transform(get_image(read_image(data[j+k][test_data[j+k][l]])))
  File "b4++.py", line 85, in read_image
    ia = np.fromfile(f, np.uint8, x[2] * x[3])
KeyboardInterrupt

F:\code\python\hand_writing\code>